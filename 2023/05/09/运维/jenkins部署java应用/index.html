<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>运维/jenkins部署java应用 | 小黑的小站</title><meta name="description" content="jenkins部署java应用大致流程 pr推送 触发jenkins构建任务 清空jenkins工作目录 拉取git代码 在工作区创建&#x2F;Public目录 新建并写入git log 到result.html 使用Maven进行构建打包 产物在工作区的&#x2F;ruoyi-admin&#x2F;target&#x2F;ruoyi-admin.jar 将产物和Dockerfile 传到远程服务器的&#x2F;home&#x2F;xxx&#x2F;xxx-ser"><meta name="author" content="小黑"><meta name="copyright" content="小黑"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="运维/jenkins部署java应用"><meta name="twitter:description" content="jenkins部署java应用大致流程 pr推送 触发jenkins构建任务 清空jenkins工作目录 拉取git代码 在工作区创建&#x2F;Public目录 新建并写入git log 到result.html 使用Maven进行构建打包 产物在工作区的&#x2F;ruoyi-admin&#x2F;target&#x2F;ruoyi-admin.jar 将产物和Dockerfile 传到远程服务器的&#x2F;home&#x2F;xxx&#x2F;xxx-ser"><meta name="twitter:image" content="http://ynxh.xyz/img/linux.jpeg"><meta property="og:type" content="article"><meta property="og:title" content="运维/jenkins部署java应用"><meta property="og:url" content="http://ynxh.xyz/2023/05/09/%E8%BF%90%E7%BB%B4/jenkins%E9%83%A8%E7%BD%B2java%E5%BA%94%E7%94%A8/"><meta property="og:site_name" content="小黑的小站"><meta property="og:description" content="jenkins部署java应用大致流程 pr推送 触发jenkins构建任务 清空jenkins工作目录 拉取git代码 在工作区创建&#x2F;Public目录 新建并写入git log 到result.html 使用Maven进行构建打包 产物在工作区的&#x2F;ruoyi-admin&#x2F;target&#x2F;ruoyi-admin.jar 将产物和Dockerfile 传到远程服务器的&#x2F;home&#x2F;xxx&#x2F;xxx-ser"><meta property="og:image" content="http://ynxh.xyz/img/linux.jpeg"><meta property="article:published_time" content="2023-05-09T06:27:04.701Z"><meta property="article:modified_time" content="2023-05-09T06:33:46.896Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://ynxh.xyz/2023/05/09/%E8%BF%90%E7%BB%B4/jenkins%E9%83%A8%E7%BD%B2java%E5%BA%94%E7%94%A8/"><link rel="prev" title="运维/网络相关" href="http://ynxh.xyz/2023/05/09/%E8%BF%90%E7%BB%B4/%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3/"><link rel="next" title="运维/jenkins使用" href="http://ynxh.xyz/2023/04/25/%E8%BF%90%E7%BB%B4/jenkins%E4%BD%BF%E7%94%A8/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"http://ynxh.xyz","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">125</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#jenkins部署java应用"><span class="toc-number">1.</span> <span class="toc-text">jenkins部署java应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#大致流程"><span class="toc-number">1.0.1.</span> <span class="toc-text">大致流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#尝试方式一"><span class="toc-number">1.0.2.</span> <span class="toc-text">尝试方式一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#尝试方式二"><span class="toc-number">1.0.3.</span> <span class="toc-text">尝试方式二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#这里有几个坑记录下"><span class="toc-number">1.0.4.</span> <span class="toc-text">这里有几个坑记录下</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#以下回答来自gpt，亲测可用"><span class="toc-number">1.0.4.1.</span> <span class="toc-text">以下回答来自gpt，亲测可用</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/linux.jpeg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">小黑的小站</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">运维/jenkins部署java应用</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2023-05-09 14:27:04"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2023-05-09</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2023-05-09 14:33:46"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2023-05-09</span></time></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">2.5k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 12 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="jenkins部署java应用"><a href="#jenkins部署java应用" class="headerlink" title="jenkins部署java应用"></a>jenkins部署java应用</h1><h3 id="大致流程"><a href="#大致流程" class="headerlink" title="大致流程"></a>大致流程</h3><ol>
<li>pr推送</li>
<li>触发jenkins构建任务</li>
<li>清空jenkins工作目录</li>
<li>拉取git代码</li>
<li>在工作区创建/Public目录</li>
<li>新建并写入git log 到result.html</li>
<li>使用Maven进行构建打包</li>
<li>产物在工作区的/ruoyi-admin/target/ruoyi-admin.jar</li>
<li>将产物和Dockerfile 传到远程服务器的/home/xxx/xxx-server 目录</li>
<li>在远程服务器端 执行docker build 打包成xxx-server镜像</li>
<li>在远程服务端 执行 docker run 运行在20111端口，并把日志挂载到 /home/xxx/xxx-server/logs</li>
<li>向slack推送</li>
</ol>
<p>实现方式：</p>
<ol>
<li>安装maven ，Publish Over SSH , docker 插件 ，使用maven project 流程来构建</li>
<li>使用pipeline 和 jenkinsfile 自定义流程 的方式实现。</li>
</ol>
<h3 id="尝试方式一"><a href="#尝试方式一" class="headerlink" title="尝试方式一"></a>尝试方式一</h3><ul>
<li>安装maven 插件，配置自动安装</li>
<li>安装docker 插件，配置自动安装</li>
<li>安装 Publish Over SSH 插件，配置时发现，ssh测试一直不能成功。<br> 步骤如下：  <ol>
<li>将jenkins 容器中的.ssh 下的id_rsa.pub 公钥拷贝到 远程服务器的authorized_keys 文件</li>
<li>将jenkins 容器中的.ssh 下的id_rsa 私钥拷贝到jenkins 的SSH 插件全局配置</li>
<li>test 报错 class="lazyload" data-src="https://user-images.githubusercontent.com/40491203/236610686-32ffdb4b-b6e0-42f8-8d04-8e215aea6d19.png" <img width="1243" alt="image" src="/">

</li>
</ol>
</li>
</ul>
<blockquote>
<p>然而，直接在容器内，ssh 是可以免密直接连接到远程的，就是这个插件的test过不去。</p>
</blockquote>
<ul>
<li><p>新建maven 项目构建流程</p>
</li>
<li><p>在jenkins容器中 .ssh目录 生成密钥对</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C &quot;xxx-server@troy.com&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置git 地址与deploy key</p>
</li>
<li><p>配置webhook</p>
</li>
<li><p>配置build 命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clean package -Dmaven.test.skip&#x3D;true</span><br></pre></td></tr></table></figure>
</li>
<li><p>构建成功后 执行 Send build artifacts over SSH 把jar包和dockerfile 丢过去</p>
</li>
<li><p>构建成功后 再执行  shell 脚本 进行docker build 和 run</p>
</li>
</ul>
<blockquote>
<p>由于卡在了  Publish Over SSH 插件 配置，而且这个方式似乎不够灵活，还需要添加一些shell脚本来实现git log 写入和slack推送等，而且还得去学习各种插件配置，无法把已有的jenkinsfile 中的流程一键迁移（也得一个一个加shell脚本搞），遂暂时放弃。去搞方式二</p>
</blockquote>
<h3 id="尝试方式二"><a href="#尝试方式二" class="headerlink" title="尝试方式二"></a>尝试方式二</h3><ol>
<li>项目根目录创建 jenkinsfile 推到仓库</li>
<li>在jenkinsfile 语法中完成下面步骤👇🏻</li>
<li>调用sh 命令完成打包步骤</li>
<li>把产物和dockerfile丢到远程服务器</li>
<li>ssh 到远程服务器打包镜像和运行镜像</li>
<li>运行成功后，slack推送消息</li>
</ol>
<h3 id="这里有几个坑记录下"><a href="#这里有几个坑记录下" class="headerlink" title="这里有几个坑记录下"></a>这里有几个坑记录下</h3><ol>
<li><p>由于jenkins容器中是没有安装过docker和maven的，必须手动去安装一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install maven</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装docker是个坑，apt源没有docker</p>
</li>
</ol>
<h4 id="以下回答来自gpt，亲测可用"><a href="#以下回答来自gpt，亲测可用" class="headerlink" title="以下回答来自gpt，亲测可用"></a>以下回答来自gpt，亲测可用</h4><p>   要在Debian GNU/Linux 11上安装Docker，您可以按照以下步骤操作：</p>
<ol>
<li><p>更新软件包列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装依赖包，以便您可以通过HTTPS使用Docker存储库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install apt-transport-https ca-certificates curl gnupg2 software-properties-common</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加Docker官方GPG密钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;debian&#x2F;gpg | sudo gpg --dearmor -o &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;docker-archive-keyring.gpg</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加Docker存储库到您的APT源列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo \</span><br><span class="line">  &quot;deb [arch&#x3D;amd64 signed-by&#x3D;&#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;docker-archive-keyring.gpg] https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;debian \</span><br><span class="line">  $(lsb_release -cs) stable&quot; | sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;docker.list &gt; &#x2F;dev&#x2F;null</span><br><span class="line">&#96;&#96;&#96;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新APT软件包列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装Docker Engine和docker-compose：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动Docker服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
</li>
<li><p>验证Docker是否已成功安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run hello-world</span><br><span class="line"></span><br><span class="line">如果一切正常，您应该会看到一个欢迎消息，表示Docker已经成功安装。</span><br></pre></td></tr></table></figure>
</li>
<li><p>docker build 必须要进入到远程部署目录去执行，这个点没注意就会在当前工作目录执行了。</p>
</li>
<li><p>语法坑，注意转义符号，双引号内的双引号，这样才能保证在 ssh 后的远程目录执行docekr build</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh &quot;ssh $&#123;env.DEPLOY_REMOTE_SERVER&#125; \&quot;cd $&#123;env.DEPLOY_DIR_MAIN&#125; &amp;&amp; pwd &amp;&amp; docker build -t xxx-server .\&quot;&quot;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<ol start="5">
<li>权限坑 ，xxx用户是没有docker 命令运行权限的。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">permission denied while trying to connect to the Docker daemon socket at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock: Get &quot;http:&#x2F;&#x2F;%2Fvar%2Frun%2Fdocker.sock&#x2F;_ping&quot;: dial unix &#x2F;var&#x2F;run&#x2F;docker.sock: connect: permission denied</span><br></pre></td></tr></table></figure>

<p>   需要切换到root用户执行，把xxx用户添加到docker用户组</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -aG docker xxx</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>运行在docker 中的java程序想要链接另一个容器的redis，不能使用127.0.0.1 或者localhost</li>
</ol>
<ul>
<li><p>可以在运行时候，redis，java应用都使用 -network 组同一个网，然后使用容器名称连接即可</p>
</li>
<li><p>或者使用命令查看下redis 的容器地址。使用容器ip地址来连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect -f &#39;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#39; redis</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="7">
<li><p>docker run 运行的时候一定要记得加上-d 后台运行，不然无法执行到下一步。</p>
</li>
<li><p>java项目Captcha生成验证码，docker部署时字体包空指针异常<br>原因是制作镜像时使用的 openjdk:8-jdk-alpine 没有相关字体包，调用createImage()方法时，会报空指针异常<br>解决方案就是在dockerfile中增加以下代码：</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8-jre-alpine</span><br><span class="line"></span><br><span class="line">#captcher 字体包</span><br><span class="line">RUN set -xe \</span><br><span class="line">&amp;&amp; apk --no-cache add ttf-dejavu fontconfig</span><br></pre></td></tr></table></figure>

<p>最终dockerfile ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 构建镜像的第二阶段</span><br><span class="line"></span><br><span class="line">FROM openjdk:8-jre-alpine</span><br><span class="line"></span><br><span class="line"># captcher 字体包</span><br><span class="line">RUN set -xe \</span><br><span class="line">&amp;&amp; apk --no-cache add ttf-dejavu fontconfig</span><br><span class="line"></span><br><span class="line"># 设置工作目录</span><br><span class="line"></span><br><span class="line">WORKDIR &#x2F;app</span><br><span class="line"></span><br><span class="line"># 将 jar 文件复制到容器中</span><br><span class="line"></span><br><span class="line">COPY ruoyi-admin.jar &#x2F;app&#x2F;</span><br><span class="line"></span><br><span class="line"># 暴露的端口，根据您的实际项目端口进行调整</span><br><span class="line"></span><br><span class="line">EXPOSE 20111</span><br><span class="line"></span><br><span class="line"># 设置容器启动时执行的命令</span><br><span class="line"></span><br><span class="line"># ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;ruoyi-admin.jar&quot;]</span><br><span class="line">ENTRYPOINT [&quot;java&quot;, &quot;-Xms256m&quot;, &quot;-Xmx1024m&quot;, &quot;-XX:MetaspaceSize&#x3D;128m&quot;, &quot;-XX:MaxMetaspaceSize&#x3D;512m&quot;, &quot;-jar&quot;, &quot;ruoyi-admin.jar&quot;]</span><br><span class="line"></span><br><span class="line"># 添加下面这一行，将宿主机的日志目录挂载到容器中</span><br><span class="line"></span><br><span class="line">VOLUME &#x2F;home&#x2F;xxxx&#x2F;logs:&#x2F;app&#x2F;logs</span><br></pre></td></tr></table></figure>

<p>jekinsfile:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line"></span><br><span class="line">    environment &#123;</span><br><span class="line">        &#x2F;&#x2F; 目录隶属用户用户组</span><br><span class="line">        DEPLOY_DIR_USER &#x3D; &#39;xxx&#39;</span><br><span class="line">        &#x2F;&#x2F; 项目</span><br><span class="line">        PROJECT_MAIN &#x3D; &#39;main_project&#39;</span><br><span class="line">        &#x2F;&#x2F; 打包好的主目录</span><br><span class="line">        TARGET_HOME_DIR &#x3D; &quot;$&#123;env.WORKSPACE&#125;&quot;</span><br><span class="line">        &#x2F;&#x2F; 远程主机ip</span><br><span class="line">        DEPLOY_REMOTE_SERVER &#x3D; &#39;xxx@10.0.0.远程&#39;</span><br><span class="line">        &#x2F;&#x2F; 远程部署目录</span><br><span class="line">        DEPLOY_DIR_MAIN &#x3D; &quot;$&#123;params.DEPLOY_DIR_MAIN&#125;&quot;</span><br><span class="line">        &#x2F;&#x2F; jar包路径</span><br><span class="line">        JAR_DIR &#x3D; &#39;ruoyi-admin&#x2F;target&#x2F;ruoyi-admin.jar&#39;</span><br><span class="line"></span><br><span class="line">        JAR_NAME &#x3D; &#39;ruoyi-admin.jar&#39;</span><br><span class="line"></span><br><span class="line">        CONTAINER_NAME &#x3D; &#39;xxx-server&#39;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#39;Clean&#39;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                &#x2F;&#x2F; clean workspace</span><br><span class="line">                cleanWs()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(&#39;Checkout&#39;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                dir(&quot;$&#123;env.PROJECT_MAIN&#125;&quot;) &#123;</span><br><span class="line">                    checkout scm</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(&#39;Create Directories&#39;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh &quot;mkdir -p $&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;public&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#39;Generate log HTML &#39;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &quot;$&#123;params.environmental_main&#125;&quot;</span><br><span class="line">                dir(&quot;$&#123;env.PROJECT_MAIN&#125;&quot;) &#123;</span><br><span class="line">                    sh &quot;git log -20 --grep&#x3D;\&quot;^Merge pull request\&quot; --pretty&#x3D;format:\&quot;%H&lt;br&gt;\&quot; -20 | awk &#39;&#123;printf \&quot;%s\&quot;, \$0&#125;&#39; &gt; $&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;public&#x2F;result.html&quot;</span><br><span class="line">                &#125;</span><br><span class="line">                echo &quot;version:$&#123;env.BUILD_NUMBER&#125;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#39;mvn clean package&#39;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                dir(&quot;$&#123;env.PROJECT_MAIN&#125;&quot;) &#123;</span><br><span class="line">                    sh &#39;mvn clean package -Dmaven.test.skip&#x3D;true&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#39;Deploy&#39;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">             &#x2F;&#x2F; 脚本生成</span><br><span class="line">            &#x2F;&#x2F; sshPublisher(publishers: [sshPublisherDesc(configName: &#39;nginx_server&#39;, transfers: [sshTransfer(cleanRemote: false, excludes: &#39;&#39;, execCommand: &#39;&#39;, execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: &#39;[, ]+&#39;, remoteDirectory: &#39;&#x2F;&#39;, remoteDirectorySDF: false, removePrefix: &#39;build&#39;, sourceFiles: &#39;build&#x2F;**&#39;)], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])</span><br><span class="line"></span><br><span class="line">                echo &quot;清空部署目录下的jar文件 [$&#123;env.DEPLOY_DIR_MAIN&#125;&#x2F;$&#123;env.JAR_NAME&#125;] ... start&quot;</span><br><span class="line"></span><br><span class="line">                sh &quot;ssh $&#123;env.DEPLOY_REMOTE_SERVER&#125; rm  $&#123;env.DEPLOY_DIR_MAIN&#125;&#x2F;$&#123;env.JAR_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;清空部署目录下的jar文件 [$&#123;env.DEPLOY_DIR_MAIN&#125;&#x2F;$&#123;env.JAR_NAME&#125;]  ... ok&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;清空部署目录下的DockerFile文件 [$&#123;env.DEPLOY_DIR_MAIN&#125;&#x2F;Dockerfile] ... start&quot;</span><br><span class="line"></span><br><span class="line">                sh &quot;ssh $&#123;env.DEPLOY_REMOTE_SERVER&#125; rm  $&#123;env.DEPLOY_DIR_MAIN&#125;&#x2F;Dockerfile&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;清空部署目录下的jar文件 [$&#123;env.DEPLOY_DIR_MAIN&#125;&#x2F;Dockerfile]  ... ok&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;复制部署jar文件 [$&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;$&#123;env.JAR_DIR&#125;] to [$&#123;env.DEPLOY_DIR_MAIN&#125;] ... start&quot;</span><br><span class="line"></span><br><span class="line">                sh &quot;scp -r $&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;$&#123;env.JAR_DIR&#125; $&#123;env.DEPLOY_REMOTE_SERVER&#125;:$&#123;env.DEPLOY_DIR_MAIN&#125;&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;复制部署jar文件 [$&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;$&#123;env.JAR_DIR&#125;] to [$&#123;env.DEPLOY_DIR_MAIN&#125;] ... ok&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;复制Dockerfile文件 [$&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;Dockerfile] to [$&#123;env.DEPLOY_DIR_MAIN&#125;] ... start&quot;</span><br><span class="line"></span><br><span class="line">                sh &quot;scp -r $&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;Dockerfile $&#123;env.DEPLOY_REMOTE_SERVER&#125;:$&#123;env.DEPLOY_DIR_MAIN&#125;&quot;</span><br><span class="line"></span><br><span class="line">                echo &quot;复制Dockerfile文件 [$&#123;env.TARGET_HOME_DIR&#125;&#x2F;$&#123;env.PROJECT_MAIN&#125;&#x2F;Dockerfile] to [$&#123;env.DEPLOY_DIR_MAIN&#125;] ... ok&quot;</span><br><span class="line"></span><br><span class="line">                echo &#39;docker 打包  ...start&#39;</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F; sh &quot;ssh $&#123;env.DEPLOY_REMOTE_SERVER&#125; cd $&#123;env.DEPLOY_DIR_MAIN&#125; &amp;&amp; pwd &amp;&amp; docker build -t xxx-server .&quot;</span><br><span class="line"></span><br><span class="line">                sh &quot;ssh $&#123;env.DEPLOY_REMOTE_SERVER&#125; \&quot;cd $&#123;env.DEPLOY_DIR_MAIN&#125; &amp;&amp; pwd &amp;&amp; docker build -t xxx-server .\&quot;&quot;</span><br><span class="line"></span><br><span class="line">                echo &#39;docker 打包  ...ok&#39;</span><br><span class="line"></span><br><span class="line">                script &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        echo &quot;判断下有没有$&#123;env.CONTAINER_NAME&#125;容器&quot;</span><br><span class="line">                        def containerExists &#x3D; sh(</span><br><span class="line">                        returnStatus: true,</span><br><span class="line">                        script: &quot;docker ps -aqf name&#x3D;$&#123;env.CONTAINER_NAME&#125;&quot;</span><br><span class="line">                    ) &#x3D;&#x3D; 0</span><br><span class="line">                        if (containerExists) &#123;</span><br><span class="line">                            echo &quot;$&#123;env.CONTAINER_NAME&#125;容器 存在&quot;</span><br><span class="line"></span><br><span class="line">                            sh &quot;docker stop $&#123;env.CONTAINER_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">                            echo &quot;$&#123;env.CONTAINER_NAME&#125;容器 停止&quot;</span><br><span class="line"></span><br><span class="line">                            sh &quot;docker rm $&#123;env.CONTAINER_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">                            echo &quot;$&#123;env.CONTAINER_NAME&#125;容器 删除&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                        echo &#39;docker 后台启动  ...start&#39;</span><br><span class="line"></span><br><span class="line">                        sh &quot;ssh $&#123;env.DEPLOY_REMOTE_SERVER&#125; docker run -d --name xxx-server -p 20111:20111 -v &#x2F;home&#x2F;xxx&#x2F;xxx-server&#x2F;logs:&#x2F;app&#x2F;logs -v xxx-server-data:&#x2F;data xxx-server&quot;</span><br><span class="line"></span><br><span class="line">                        echo &#39;docker 启动  ...ok&#39;</span><br><span class="line">                        &#x2F;&#x2F;调用方法得到日志 并 输出</span><br><span class="line"></span><br><span class="line">                        def changeString &#x3D; getChangeString()</span><br><span class="line">                        echo &quot;$changeString&quot;</span><br><span class="line">                        &#x2F;&#x2F; 发送消息</span><br><span class="line">                        slackSend channel: &#39;#xxx-verify&#39;, color: &#39;#7CFC00&#39;, message: &quot;xxx-server-打包部署成功 swagger文档地址：$&#123;params.deploySite1&#125; \n Build Started: $&#123;env.JOB_NAME&#125; $&#123;env.BUILD_NUMBER&#125; \n 提交信息: \n $changeString&quot;, teamDomain: &#39;xxxx&#39;, tokenCredentialId: &#39;xxx&#39;</span><br><span class="line"></span><br><span class="line">                        echo &#39;\n--------------- 部署完成 ---------------&#39;</span><br><span class="line">                &#125; catch (err) &#123;</span><br><span class="line">                        echo &quot;部署失败: $&#123;err&#125;&quot;</span><br><span class="line">                        currentBuild.result &#x3D; &#39;FAILURE&#39;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@NonCPS</span><br><span class="line">def getChangeString() &#123;</span><br><span class="line">    MAX_MSG_LEN &#x3D; 100</span><br><span class="line">    def changeString &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">    echo &#39;Gathering SCM changes&#39;</span><br><span class="line">    def changeLogSets &#x3D; currentBuild.changeSets</span><br><span class="line">    for (int i &#x3D; 0; i &lt; changeLogSets.size(); i++) &#123;</span><br><span class="line">        def entries &#x3D; changeLogSets[i].items</span><br><span class="line">        for (int j &#x3D; 0; j &lt; entries.length; j++) &#123;</span><br><span class="line">            def entry &#x3D; entries[j]</span><br><span class="line">            truncated_msg &#x3D; entry.msg.take(MAX_MSG_LEN)</span><br><span class="line">            changeString +&#x3D; &quot; - $&#123;truncated_msg&#125; [$&#123;entry.author&#125;]\n&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!changeString) &#123;</span><br><span class="line">        changeString &#x3D; &#39; - No new changes&#39;</span><br><span class="line">    &#125;</span><br><span class="line">    return changeString</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小黑</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://ynxh.xyz/2023/05/09/%E8%BF%90%E7%BB%B4/jenkins%E9%83%A8%E7%BD%B2java%E5%BA%94%E7%94%A8/">http://ynxh.xyz/2023/05/09/运维/jenkins部署java应用/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://ynxh.xyz" target="_blank">小黑的小站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/javascript.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2023/05/09/%E8%BF%90%E7%BB%B4/%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3/"><img class="prev_cover lazyload" data-src="/img/linux.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">运维/网络相关</div></div></a></div><div class="next-post pull_right"><a href="/2023/04/25/%E8%BF%90%E7%BB%B4/jenkins%E4%BD%BF%E7%94%A8/"><img class="next_cover lazyload" data-src="/img/linux.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">运维/jenkins使用</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 小黑</div><div class="footer_custom_text">Hi, welcome to my <a href="http://ynxh.xyz/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">2</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/click_heart.js"></script></body></html>